共识机制是区块链中核心的技术点。多方参与的节点在预设规则下，通过节点间的交互对数据、行为或流程达成一致的过程称为共识。共识机制是指定义共识过程的算法、协议和规则。共识机制按照共识的过程分两类，第一类是概率一致的共识、工程学上最终确认；第二类是绝对一致之后再共识，共识即确认。本区块链提供第一年采用第一类的POW算法，第一年为了代币的发行规模和传播性选择POW算法，第二年（固定区块之后）采用第二类的共识机制，自动使用共识效率高，防止网络拥堵的委任权益证明DPoS算法，其能达到秒级确认，能很好地解决了性能和能耗的问题。

DPoS算法中使用见证人机制（witness）解决中心化问题。总共有N个见证人对区块进行签名，而这些见证人由使用区块链网络的主体投票产生。由于使用了去中心化的投票机制，DPoS相比其他的系统更加民主化。DPoS并没有完全去除对于信任的要求，代表整个网络对区块进行签名的被信任主体在保护机制下确保行为正确而没有偏见。另外，每个被签名的区块都有先前区块被可信任节点签名的证明。DPoS消除了交易需要等待一定数量区块被非信任节点验证的时间消耗。

通过减少确认的要求，DPoS算法大大提高了交易的速度。通过信任少量的诚信节点，可以去除区块签名过程中不必要的步骤。DPoS的区块可以比PoW或者PoW容纳更多的交易数量，从而使加密数字货币的交易速度接近像Visa和Mastercard这样的中心化清算系统。

DPoS系统任然存在中心化，但是这种中心化是受到控制的，因为每个客户端都有能力决定哪些节点可以被信任。DPoS使得这样的区块链网络保留了一些中心化系统的关键优势，同时又能保证一定的去中心化。系统通过公平选举，使每个人都有可能成为代表绝大多数用户的委托人。
DPoS背后的理性逻辑

1.使权益所有者能够通过投票决定记账人
2.最大化权益所有者的红利
3.最小化保证网络安全的消耗
4.最大化网络的性能
5.最小化运行网络的成本

权益所有者拥有控制权

DPoS的根本特性是权益所有者保留了控制权，从而使系统去中心化。就像投票机制也有缺陷一样，DPoS是管理公司共有产权的唯一可行方式。幸运的是，如果你不喜欢运营公司的人，你可以通过卖出权益离场。而这种反馈机制可以使权益所有者在投票时比普通公民更加理性。

每个权益所有者通过投票决定区块的签名验证者，任何一个拥有超过1%投票的人都可以参与到董事会。所有的代表构成一个“董事会”，轮流签署区块。如果一个董事错过了签署区块的机会，客户会自动把投票给予其他人。最终，这些错过签署机会的董事会被取消资格，其他人就可以加入董事会。董事会成员会收到少量代币作为奖励，用来激励在线时间和参与竞选。每一个董事必须要将单个区块平均奖励的100倍作为保证金，从而确保其至少99%的在线时间。

不随机从所有用户中选择的原因

1.普通用户大部分时间不在线
2.攻击者可以使用其权益控制网络，而不经过其他人的认可
3.由于没有挖矿，在去中心化网络中生成随机数变得不可能。

扩展性

假设每笔交易的确认成本和手续费都是固定的，那么实现去中心化的数量也是有限制的。假设验证成本与手续费相等，则整个网络是完全中心化的，并且只能支持一个验证节点。假设手续费是验证成本的100倍，则网络可以支持100个验证节点。

DPOS扩展性

PoS需要大量的手续费来保证其合理运行，而委任机制是PoS高效工作的唯一方式。在PoS中可以使用权益池的方式，但是这又变成某种形式的DPoS。委任代表无法从矿池张获得实际的收益，因为验证的花费将吞噬绝大部分的交易手续费。

去中心化的成本与验证节点的数量成正比，而这个成本无法消除。从规模化角度看，这种成本的存在将最终使系统中心化，而委任代表制是唯一的解决方案。这种中心化应该在系统建设的初期就设计好，以利于用户更好地控制，而不是通过被动演化为非预期的结果。

委任代表的角色

1.见证人是允许生成和广播区块的权威
2.生成区块的过程包括收集P2P网络中的交易并使用见证人的私钥进行签名
3.见证人的位置由上一个区块的最后部分随机指定。

DPoS对于攻击的抑制

1.如果某个见证人拒绝签署一个区块，那么他将被解职并失去未来的稳定收入预期
2.不诚实的委任代表只有在明确有其他利益诉求时才会选择放弃区块生成
3.见证人无法签署无效的交易，因为交易需要所有见证人都确认。

见证人的数量

见证人的数量由权益所有者确定，系统设计至少需要确保17个见证人


出块节点（见证人）由持币用户选举投票产生，每个用户的投票权重则按照用户持币占系统总量比例计算。


在DPoS共识机制比特股，Steem和EOS的应用程序不需要用户为区块链上的操作支付费用。像传统的基于Web的应用程序一样，应用程序开发人员提供程序运行需要的资源，而不是由用户提供。

这些资源包括带宽、计算力、存储容量等。这意味着用户可以创建免费的区块链应用程序，新用户无需经历繁琐的加密数字货币购买流程，就可直接使用区块链上的应用程序。

在DPoS模式下，治理的结构是清晰的，所有的股东都有发言权。这种治理的成本与共识过程是一致的，每个人都能知道治理的政策是什么，也知道他们该怎么参与。制定决策的时候，就很清楚，不会有二义性。不会有“意外分叉”，因为区块链很清楚新的硬分叉路径，旧的节点共识会通知他们“关停”，除非他们升级了。

在正常情况下，DPOS块链不会经历任何叉，因为块生产者合作生产区块而不是竞争。如果有区块分叉，共识将自动切换到最长的链条。具有更多生产者的区块链长度将比具有较少生产者的区块链增长速度更快。此外，没有块生产者应该同时在两个区块链分叉上生产块。如果一个块生产者发现这么做了，就可能被投票出局。


被选举的证人生产 


“证人”这个词被选中是因为这是一个没有规定的合法中立的词。传统的合同往往有证人签名的地方。对于非常重要的合同， 有时会使用公证人。证人和公证人都不是合同的当事人，但是他们在证明合同是在指定的时间由特定的人签字的非常重要的角色。在比特股中，证人通过将其包含在块中来起到类似的验证签名和时间戳事务的作用。

 
在DPOS下，利益相关者可以选择任意数量的证人来生成块。块是一组更新数据库状态的事务。每个账户每个证人允许一个投票，这个过程被称为批准投票。通过总审批的前N名证人被选中。证人数量（N）的定义是至少有50％的投票利益相关方认为有足够的权力下放。当利益相关者表达他们想要的证人数量时，他们也必须投票给至少许多证人。利益相关者不能投票支持比实际投票的证人更多的权力下放。 
每当目击者产生一个块时，他们都会为他们的服务付费。他们的薪酬由利益相关方通过他们选出的代表来决定（稍后再讨论）。如果证人没有出示任何信息，那么他们就没有报酬，可能会在未来被投票出去。 


活动证人的名单在每次维护间隔（1天）内更新一次。然后将目击者洗牌，并且每个目击者轮流以每2秒一个固定的时间表产生一个块。所有目击者转了一圈之后，他们又被洗牌了。如果证人没有在他们的时间段内产生一个块，那么该时间段被跳过，下一个证人产生下一个块。 
任何人都可以通过观察证人的参与率来监测网络的健康状况。历史上，比特股保持99％的见证参与。任何时候目击者的参与程度都低于一定水平，网络用户可以允许更多的时间进行交易确认，并对其网络连接性保持警觉。此属性为BitShares提供了独特的优势，即在故障发生后不到1分钟，就可以提醒用户潜在的问题。 


通过选定的代表进行参数更改 


代表以与证人类似的方式选出。代表成为特殊帐户的共同签名者，该特殊帐户有权提出对网络参数的更改。这个帐户被称为创始帐户。这些参数包括交易费用，块大小，见证薪水和块间隔等。在大多数代表批准了拟议的变更之后，利益相关者被授予2周的审查期，在此期间他们可以对代表投票并使提议的变更无效。 


这种设计的选择是为了确保代表在技术上没有直接的权力，网络参数的所有变化最终都得到了利益相关者的认可。这样做是为了保护代表不受可能适用于加密货币的经理或管理员的规定的影响。在DPOS下，我们可以说，行政权力掌握在用户手中，而不是代表或证人。

 
与证人不同的是，代表们不是有偿职位。但是，这些参数预计不会经常变化。

 
的成因帐户在技术上可以执行任何其他帐户可以执行任何动作，这意味着它可以发送资金的成因帐户或指定成因帐户作为托管代理。该创世记也可用于发放新的资产。选举代表可以帮助利益相关者执行需要高度信任和责任感的任务，其数量不胜枚举。 


改变规则（或者说硬分叉） 


有时需要升级网络来添加新的功能。在DPOS下，所有的改变都必须由积极的利益相关者的批准来触发。虽然证人在技术上可能单方面串通和改变他们的软件，但这样做并不符合他们的利益。证人的选择是基于他们对区块链政策保持中立的承诺。保持中立保护证人免受指控他们是网络的管理员/经理/业主/经营者。证人只是利益相关者的雇员。 
开发人员可以实施他们认为合适的任何更改，只要这些更改取决于利益相关方的批准。这一政策对开发者的保护就像保护利益相关者一样，并确保没有任何人单方面控制网络的方向。

 
改变规则的门槛与替换51％的当选证人相同。利益相关者参与选举证人越多，就越难改变规则。

 
最终，更改规则取决于网络上的每个人升级他们的软件，并且没有区块链协议可以执行规则如何改变。这意味着只要坚持代码普遍预期的行为，就可以在不需要利益相关者投票的情况下推出硬分支“错误修复”。

 
在实践中，只有安全关键的硬件应该以这种方式来实现。开发商和证人应该等待利益相关者批准即使是最微小的变化。 


双重支出攻击 


在区块链重组排除之前包括的交易的情况下，双重花费可能发生。这意味着目击者因互联网基础设施的中断而导致通信故障。使用DPOS，通信故障导致双重支出攻击的可能性非常低。

 
该网络能够监测自己的健康状况，并能立即发现通讯中的任何损失，因为目击者未能及时制造积木。发生这种情况时，用户可能需要等到一半的证人确认交易，这可能是一两分钟。 


交易作为证明 


网络上的每个事务可以可选地包括最近块的散列。如果这样做，交易的签署人可以确信他们的交易可能不适用于任何不包含该块的区块链。这个过程的一个副作用是，随着时间的推移，所有利益相关者最终直接证明了交易历史的长期完整性。 


区块链重组 


由于所有的证人都是选举出来的，负有很大的责任，并且有专门的时间段来生产区块，所以很少有可能存在两个相互竞争的连锁的情况。网络延迟不时会阻止一名见证人及时收到前面的信息。如果发生这种情况，下一个证人将通过建立在他们首先接受的任何一个块上来解决问题。有99％的证人参与，交易有一个99％的机会证实一个证人后。 
尽管该系统对于自然链重组事件是有力的，但是仍有一些潜在的软件错误，网络中断，或无能或恶意的证人产生比一个或两个块长的多个竞争历史。软件始终选择证人参与率最高的区块链。证人自己经营，每轮只能生产一个块，参与率一般比较低。没有任何证人（或少数证人）能够做出更高参与率的区块链。参与率通过比较产生的块的预期数量与实际产生的块的数量来计算。 


最大限度地分散 


在DPOS下，每个利益相关者的影响力与其利益成正比，没有利益相关者被排除在影响之外。市场上的其他每一个共识系统都不包括绝大多数利益相关者的参与。有许多不同的方法可以替代利益相关者。一些替代方案使用仅限邀请的系统。其他人通过让参与费用高于他们的收入来排除参与。其他的系统在技术上也允许每个人都参与，但是他们可以被一些产生绝大多数块的大型玩家安全地忽略。只有DPOS确保块生产平均分配给大多数人，每个人都有一个经济上可行的方式来影响这些人是谁。






